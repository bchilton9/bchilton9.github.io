<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Gadget Guide</title>
<style>
  body {
    background-color: #121212;
    color: #f5f5f5;
    font-family: sans-serif;
    margin: 0; padding: 0;
  }
  header, footer {
    background: #1e1e1e;
    padding: 1rem;
    text-align: center;
  }
  main {
    padding: 1rem;
    max-width: 800px;
    margin: auto;
  }
  .card {
    background: #1f1f1f;
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 8px;
    cursor: pointer;
  }
  .card:hover {
    background: #2a2a2a;
  }
  input, button, select, textarea {
    margin: 0.5rem 0;
    padding: 0.5rem;
    border-radius: 4px;
    border: none;
    font-family: monospace;
  }
  input {
    width: 100%;
    box-sizing: border-box;
  }
  #pagination button {
    margin: 0 0.2rem;
    padding: 0.4rem 0.7rem;
    background: #333;
    color: #f5f5f5;
    border-radius: 4px;
    border: none;
    cursor: pointer;
  }
  #pagination button.active {
    background: #666;
  }
  #articleView {
    display: none;
  }
  #articleView h1 {
    margin-top: 0;
  }
  #backBtn, #editBtn, #saveBtn, #cancelBtn {
    background: #444;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    margin: 0.5rem 0.3rem 1rem 0;
  }
  #articleImage {
    max-width: 100%;
    border-radius: 8px;
    margin-bottom: 1rem;
  }
  #editorArea {
    width: 100%;
    height: 200px;
    background: #222;
    color: #eee;
    border-radius: 6px;
    display: none;
  }
  a {
    color: #6cf;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<header><h1>The Gadget Guide</h1></header>

<main>
  <div id="listView">
    <input type="text" id="searchInput" placeholder="Search articles..." />

    <div id="articlesContainer"></div>
    <div id="pagination"></div>
  </div>

  <div id="articleView">
    <button id="backBtn">‚Üê Back to Articles</button>
    <h1 id="articleTitle"></h1>
    <img id="articleImage" alt="" />
    <div id="articleContent"></div>

    <textarea id="editorArea"></textarea><br />
    <button id="editBtn">Edit Article</button>
    <button id="saveBtn" style="display:none;">Save Changes</button>
    <button id="cancelBtn" style="display:none;">Cancel</button>
  </div>
</main>

<footer>&copy; 2025 The Gadget Guide</footer>

<script>
(() => {
  let articles = [
    {
      id: "smartphones-2025",
      title: "Top 5 Smartphones of 2025",
      summary: "A look at the latest flagship devices of the year.",
      image: "https://via.placeholder.com/400x200",
      content: "## Smartphones of 2025\\n\\nHere are the best phones this year with exciting new features and innovations. Stay tuned for the full review."
    },
    {
      id: "laptop-trends",
      title: "Laptop Trends You Need to Know",
      summary: "The biggest trends in laptops for the coming year.",
      image: "https://via.placeholder.com/400x200",
      content: "### Lightweight and powerful\\nThe new generation of laptops balances portability with performance, perfect for work and gaming."
    },
    {
      id: "smart-home",
      title: "Smart Home Devices Overview",
      summary: "Making your home smarter and more connected.",
      image: "https://via.placeholder.com/400x200",
      content: "Smart home devices are evolving rapidly. From voice assistants to smart thermostats, find out what fits your lifestyle."
    }
  ];

  const perPage = 3;
  let currentPage = 1;
  let filteredArticles = articles;
  let currentArticle = null;

  const listView = document.getElementById('listView');
  const articleView = document.getElementById('articleView');
  const articlesContainer = document.getElementById('articlesContainer');
  const pagination = document.getElementById('pagination');
  const searchInput = document.getElementById('searchInput');

  const backBtn = document.getElementById('backBtn');
  const editBtn = document.getElementById('editBtn');
  const saveBtn = document.getElementById('saveBtn');
  const cancelBtn = document.getElementById('cancelBtn');
  const editorArea = document.getElementById('editorArea');
  const articleContent = document.getElementById('articleContent');

  function renderArticles() {
    const start = (currentPage - 1) * perPage;
    const pageArticles = filteredArticles.slice(start, start + perPage);
    articlesContainer.innerHTML = pageArticles.map(a => `
      <div class="card" data-id="${a.id}">
        <img src="${a.image}" alt="${a.title}" />
        <h2>${a.title}</h2>
        <p>${a.summary}</p>
      </div>
    `).join('');

    renderPagination();
    [...articlesContainer.children].forEach(card => {
      card.addEventListener('click', () => {
        openArticle(card.getAttribute('data-id'));
      });
    });
  }

  function renderPagination() {
    const totalPages = Math.ceil(filteredArticles.length / perPage);
    pagination.innerHTML = '';
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement('button');
      btn.textContent = i;
      btn.classList.toggle('active', i === currentPage);
      btn.addEventListener('click', () => {
        currentPage = i;
        renderArticles();
        window.scrollTo(0,0);
      });
      pagination.appendChild(btn);
    }
  }

  function openArticle(id) {
    const article = articles.find(a => a.id === id);
    if (!article) return;
    currentArticle = article;
    listView.style.display = 'none';
    articleView.style.display = 'block';
    articleContent.style.display = 'block';
    editorArea.style.display = 'none';
    saveBtn.style.display = 'none';
    cancelBtn.style.display = 'none';
    editBtn.style.display = 'inline-block';

    document.getElementById('articleTitle').textContent = article.title;
    document.getElementById('articleImage').src = article.image;
    document.getElementById('articleImage').alt = article.title;
    articleContent.innerHTML = marked.parse(article.content);
    window.scrollTo(0,0);
  }

  backBtn.addEventListener('click', () => {
    articleView.style.display = 'none';
    listView.style.display = 'block';
    currentArticle = null;
    window.scrollTo(0,0);
  });

  editBtn.addEventListener('click', () => {
    if (!sessionStorage.getItem('editUnlocked')) {
      const pass = prompt('Enter editor password:');
      if (pass !== 'gadget123') {
        alert('Incorrect password');
        return;
      }
      sessionStorage.setItem('editUnlocked', 'true');
    }
    articleContent.style.display = 'none';
    editorArea.style.display = 'block';
    editorArea.value = currentArticle.content;
    editBtn.style.display = 'none';
    saveBtn.style.display = 'inline-block';
    cancelBtn.style.display = 'inline-block';
    editorArea.focus();
  });

  saveBtn.addEventListener('click', () => {
    currentArticle.content = editorArea.value;
    articleContent.innerHTML = marked.parse(currentArticle.content);
    articleContent.style.display = 'block';
    editorArea.style.display = 'none';
    saveBtn.style.display = 'none';
    cancelBtn.style.display = 'none';
    editBtn.style.display = 'inline-block';

    console.log('Updated article JSON:', JSON.stringify(currentArticle, null, 2));
    alert('Changes saved locally! Refresh will lose changes unless you copy JSON from console.');
  });

  cancelBtn.addEventListener('click', () => {
    articleContent.style.display = 'block';
    editorArea.style.display = 'none';
    saveBtn.style.display = 'none';
    cancelBtn.style.display = 'none';
    editBtn.style.display = 'inline-block';
  });

  searchInput.addEventListener('input', () => {
    const term = searchInput.value.trim().toLowerCase();
    filteredArticles = articles.filter(a =>
      a.title.toLowerCase().includes(term) ||
      a.summary.toLowerCase().includes(term) ||
      a.content.toLowerCase().includes(term)
    );
    currentPage = 1;
    renderArticles();
  });

  renderArticles();
})();
</script>

</body>
</html>
